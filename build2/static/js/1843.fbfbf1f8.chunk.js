"use strict";(self.webpackChunkmantis_free_react_admin_template=self.webpackChunkmantis_free_react_admin_template||[]).push([[1843],{785417:(e,t,s)=>{s.r(t),s.d(t,{default:()=>v});var i=s(747313),a=s(809019),l=s(261113),n=s(258467),r=s(118197),c=s(999519),o=s(948935),d=s(534628),m=s(301550),p=s(896217),u=s(636671),g=s(576733),h=s.n(g),x=s(536287),j=s(346417);const v=()=>{const[e,t]=(0,i.useState)(!1),s=(0,n.s0)(),[g,v]=(0,i.useState)([]),{updID:P}=(0,n.UO)(),[f,N]=(0,i.useState)(),[_,y]=(0,i.useState)([]),[b,S]=(0,i.useState)({title:null===f||void 0===f?void 0:f.title,location:"",description:"",price:0});(0,i.useEffect)((()=>{1!=P&&L()}),[P]),(0,i.useEffect)((()=>{null!==f&&void 0!==f&&f.title?(S({...b,title:f.title,location:f.location,description:f.description,price:f.price}),v(f.images),y(f.images)):S({...b,title:"",location:"",description:"",price:""})}),[f]);const[Z,w]=(0,i.useState)(0),E=e=>{S({...b,[e.target.name]:e.target.value})},[C,k]=(0,i.useState)({title:"",location:"",description:"",price:"",img:""});console.log("error",C);const{title:I,location:D,description:W,price:F,img:R}=C;(0,i.useEffect)((()=>{!0===I&&!0===D&&!0===W&&!0===F&&!0===R&&(1!=P?G():T())}),[Z,I,D,W,F]);const T=async()=>{t(!0);const e=_.filter((e=>void 0!==e)),i={...b,images:e};try{200==(await r.b.post("/user/createProduct",i)).status?((0,c.dr)("Item Successfully Listed"),t(!1),s("/user/market-place-list")):((0,c.YE)("Something Wen't Wrong !!"),t(!1))}catch(C){console.log(C),t(!1),(0,c.YE)("Something Wen't Wrong !!")}},G=async()=>{t(!0);const e=_.filter((e=>void 0!==e)),i={...b,images:e};try{var a;const e=await fetch("".concat(x.ZP.url,"/user/updateProduct/").concat(P),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null===(a=(0,c.T8)())||void 0===a?void 0:a.jwt)},body:JSON.stringify(i)});200==(await e.json()).status?((0,c.dr)(" Item Successfully Updated "),s("/user/market-place-list"),t(!1)):((0,c.YE)("Something Wen't Wrong !!"),t(!1))}catch(C){console.log(C),t(!1),(0,c.YE)("Something Wen't Wrong !!")}},L=async()=>{try{const e=await fetch("".concat(x.ZP.url,"/user/getProductById/").concat(P),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.jwt)}}),t=await e.json();200==t.status&&N(null===t||void 0===t?void 0:t.getProduct)}catch(C){N()}},U=e=>["image/jpeg","image/png"," image/jpg"].includes(e.type)?e.size>2097152?(k((e=>({...e,img:"File size exceeds 2MB limit. Please select a smaller file."}))),!1):(k((e=>({...e,img:!0}))),!0):(k((e=>({...e,img:"Invalid file type. Please select a valid image (JPG, JPEG, PNG)."}))),!1);return(0,j.jsx)("div",{children:(0,j.jsxs)(a.ZP,{container:!0,children:[(0,j.jsx)(a.ZP,{item:!0,xs:12,sx:{mt:3.25},children:(0,j.jsx)(l.Z,{variant:"h5",className:"global_top_head",children:"Add Market Place"})}),(0,j.jsx)(a.ZP,{className:"pt-4",container:!0,spacing:2,children:(0,j.jsx)(a.ZP,{item:!0,xl:12,lg:12,md:12,children:(0,j.jsxs)("div",{className:"product_upload_img top_box",children:[(0,j.jsx)(a.ZP,{container:!0,sx:{justifyContent:"center"},children:(0,j.jsxs)(a.ZP,{xl:6,lg:6,md:6,xs:12,children:[(0,j.jsx)(m.Z,{fullWidth:!0,children:(0,j.jsx)("div",{className:"file-uploader",children:(0,j.jsxs)("label",{htmlFor:"iamgesID",className:"global_file_upload_deisgn",children:[(0,j.jsx)(d.default,{}),"Upload Document",(0,j.jsx)("p",{className:"m-0",children:"Image (JPG, JPEG, PNG) or Document (PDF)."}),(0,j.jsx)("input",{type:"file",id:"iamgesID",multiple:!0,onChange:e=>{const t=e.target.files,s=[],i=[];for(let a=0;a<t.length;a++){const e=t[a];if(U(e)){const a=new FileReader;a.onload=e=>{var a;s.push(e.target.result),i.push(null===(a=e.target.result)||void 0===a?void 0:a.split(",")[1]),s.length===t.length&&(v((e=>[...e,...s])),y((e=>[...e,...i])))},a.readAsDataURL(e)}}},className:"d-none"})]})})}),(0,j.jsx)("div",{className:"market_place preview_upload",children:g.map(((e,t)=>(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)("div",{className:"preview_upload_inner",children:[(0,j.jsx)("img",{src:e,alt:"Preview ".concat(t)},t),(0,j.jsx)("button",{className:"text-danger",onClick:()=>{return e=t,v((t=>t.filter(((t,s)=>s!==e)))),void y((t=>t.filter(((t,s)=>s!==e))));var e},children:(0,j.jsx)(p.default,{})})]})})))}),C.img&&(0,j.jsx)("p",{style:{color:"red"},children:C.img})]})}),(0,j.jsxs)(a.ZP,{container:!0,spacing:2,className:"mt-5",children:[(0,j.jsx)(a.ZP,{item:!0,xl:4,lg:4,md:4,sm:6,xs:12,children:(0,j.jsxs)("div",{className:"group  error",children:[(0,j.jsx)("input",{className:"inputMaterial",type:"text",name:"title",onChange:E,placeholder:"Enter your Product Title",value:b.title}),(0,j.jsx)("span",{className:"bar"}),(0,j.jsxs)("label",{htmlFor:"first",children:["Title ",(0,j.jsx)("span",{className:"dot_alert",children:"*"})]}),(0,j.jsx)("span",{className:"errmsg",children:C.title})]})}),(0,j.jsx)(a.ZP,{item:!0,xl:4,lg:4,md:4,sm:6,xs:12,children:(0,j.jsxs)("div",{className:"location_search group error",children:[(0,j.jsx)(o.ZP,{value:b.location,name:"location",onChange:e=>{S((t=>({...t,location:e})))},onSelect:async e=>{try{S((t=>({...t,location:e})))}catch(C){console.error("Error selecting address",C)}},searchOptions:{componentRestrictions:{country:"AU"}},children:e=>{let{getInputProps:t,suggestions:s,getSuggestionItemProps:a,loading:l}=e;return(0,j.jsxs)("div",{className:"location_input mb-0",children:[(0,j.jsxs)("span",{className:"top_text mb-0",children:["Location ",(0,j.jsx)("span",{className:"dot_alert",children:"*"})]}),(0,j.jsx)("input",{className:"mb-0",...t({placeholder:"Type address"})}),(0,j.jsxs)("div",{className:"autocomplete-dropdown-container",children:[l?(0,j.jsx)("div",{children:"Loading..."}):null,null===s||void 0===s?void 0:s.map((e=>{const t={backgroundColor:e.active?"whitesmoke":"#fff",padding:"10px 10px",cursor:"pointer"};return(0,i.createElement)("div",{...a(e,{style:t}),key:e.placeId},e.description)}))]})]})}}),(0,j.jsx)("span",{className:"errmsg",children:C.location})]})}),(0,j.jsx)(a.ZP,{item:!0,xl:4,lg:4,md:4,sm:6,xs:12,children:(0,j.jsxs)("div",{className:"group  error",children:[(0,j.jsx)("input",{className:"inputMaterial",value:b.price,name:"price",type:"text",maxLength:5,onChange:E,placeholder:"Enter Price"}),(0,j.jsx)("span",{className:"bar"}),(0,j.jsxs)("label",{htmlFor:"first",children:["Price ",(0,j.jsx)("span",{className:"dot_alert",children:"*"})]}),(0,j.jsx)("span",{className:"errmsg",children:C.price})]})}),(0,j.jsxs)(a.ZP,{item:!0,xl:12,lg:12,md:12,sm:12,xs:12,children:[(0,j.jsxs)("p",{children:["Description ",(0,j.jsx)("span",{className:"dot_alert",children:"*"})]}),(0,j.jsx)(u.CKEditor,{editor:h(),data:b.description,onChange:(e,t)=>{const s=t.getData();S((e=>({...e,description:s})))}}),(0,j.jsx)("span",{className:"errmsg",children:C.description})]}),(0,j.jsx)(a.ZP,{item:!0,xl:12,lg:12,md:12,sm:12,xs:12,className:"text-end",children:e?(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)("button",{className:"global_btn",children:[(0,j.jsx)("div",{className:"spinner-border spinner-border-sm me-1",role:"status"})," Loading ..."]})}):(0,j.jsx)("button",{className:"global_btn",onClick:()=>{w(Z+1),""==b.title.trim()?k((e=>({...e,title:"Required *"}))):k((e=>({...e,title:!0}))),0==g.length?k((e=>({...e,img:"Required *"}))):k((e=>({...e,img:!0}))),""==b.location.trim()?k((e=>({...e,location:"Required *"}))):k((e=>({...e,location:!0}))),""==b.description.trim()?k((e=>({...e,description:"Required *"}))):k((e=>({...e,description:!0}))),""==b.price?k((e=>({...e,price:"Required *"}))):/^[0-9]*$/.test(b.price)?k((e=>({...e,price:!0}))):k((e=>({...e,price:"Enter Valid Price "})))},children:1!=P?"Update Product":"Publish"})})]})]})})})]})})}}}]);